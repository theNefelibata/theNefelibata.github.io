<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://theNefelibata.github.io/</id>
    <title>theNefelibata</title>
    <updated>2022-04-27T15:02:00.714Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://theNefelibata.github.io/"/>
    <link rel="self" href="https://theNefelibata.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://theNefelibata.github.io/images/avatar.png</logo>
    <icon>https://theNefelibata.github.io/favicon.ico</icon>
    <rights>All rights reserved 2022, theNefelibata</rights>
    <entry>
        <title type="html"><![CDATA[C++æ™ºèƒ½æŒ‡é’ˆå®ç°]]></title>
        <id>https://theNefelibata.github.io/post/czhi-neng-zhi-zhen-shi-xian/</id>
        <link href="https://theNefelibata.github.io/post/czhi-neng-zhi-zhen-shi-xian/">
        </link>
        <updated>2021-06-06T14:47:37.000Z</updated>
        <content type="html"><![CDATA[<p><code>std::share_prt</code></p>
<p><code>std:unique_ptr</code></p>
<p><code>std::weak_ptr</code></p>
<h3 id="æ·±æ‹·è´ä¸æµ…æ‹·è´">æ·±æ‹·è´ä¸æµ…æ‹·è´</h3>
<ul>
<li>æ·±æ‹·è´ä¼˜ç¼ºç‚¹
<ul>
<li>ä¼˜ç‚¹ï¼šæ¯ä¸€ä¸ªå¯¹è±¡ï¼ˆå³ä½¿æ˜¯é€šè¿‡æ‹·è´æ„é€ å‡½æ•°å®ä¾‹åŒ–çš„å¯¹è±¡ï¼‰çš„æŒ‡é’ˆéƒ½æœ‰æŒ‡å‘çš„å†…å­˜ç©ºé—´ï¼Œè€Œä¸æ˜¯å…±äº«ï¼Œè¿™æ ·åœ¨é‡Šæ”¾çš„æ—¶å€™å°±ä¸å­˜åœ¨é‡å¤é‡Šæ”¾æˆ–è€…æ˜¯å†…å­˜æ³„æ¼é—®é¢˜äº†</li>
<li>ç¼ºç‚¹ï¼šå†…å­˜å¼€é”€å¤§</li>
</ul>
</li>
<li>æµ…æ‹·è´ä¼˜ç¼ºç‚¹
<ul>
<li>é€šè¿‡æ‹·è´æ„é€ å‡½æ•°å®ä¾‹åŒ–çš„æŒ‡é’ˆæ•°æ®å˜é‡æŒ‡å‘çš„æ˜¯å…±äº«çš„å†…å­˜ç©ºé—´ï¼Œå› æ­¤å†…å­˜å¼€é”€å°ã€‚</li>
<li>å¯¹è±¡ææ„çš„æ—¶å€™å¯èƒ½ä¼šé‡å¤é‡Šæ”¾æˆ–é€ æˆå†…å­˜æ³„æ¼ã€‚</li>
</ul>
</li>
</ul>
<h2 id="å¼•ç”¨è®¡æ•°">å¼•ç”¨è®¡æ•°ï¼š</h2>
<h3 id="å¯¹æµ…æ‹·è´è¿›è¡Œä¼˜åŒ–">å¯¹æµ…æ‹·è´è¿›è¡Œä¼˜åŒ–</h3>
<pre><code class="language-cpp">struct RefValue 
{

	RefValue(const char* pszName);
	~RefValue();

	void AddRef();
	void Release();

	char* m_pszName;
	int   m_nCount;
};

RefValue::RefValue(const char* pszName)
{
	m_pszName = new char[strlen(pszName)+1];
	
	m_nCount = 1;

}

RefValue::~RefValue()
{

	if (m_pszName != NULL)
	{
		delete m_pszName;
		m_pszName = NULL;
	}
}

void RefValue::AddRef()
{
	m_nCount++;
}

void RefValue::Release()
{
	if (--m_nCount == 0)
	{
		delete this;
	}
	
}
</code></pre>
<p>åœ¨è¿›è¡Œæµ…æ‹·è´æ—¶åŠ å…¥ä¸€ä¸ªå˜é‡ä¿å­˜å¼•ç”¨æ¬¡æ•°ï¼Œå¼•ç”¨ä¸€æ¬¡æ•°å€¼+1ï¼Œé‡Šæ”¾ä¸€æ¬¡æ•°å€¼-1ï¼Œå½“å¼•ç”¨è®¡æ•°ä¸º0æ—¶ï¼Œè¿›è¡Œdeleteæˆ–è€…free();</p>
<p>ä»ç„¶å­˜åœ¨çš„é—®é¢˜ï¼š</p>
<ul>
<li>å¦‚æœå¯¹å…¶ä¸­æŸä¸€ä¸ªç±»å¯¹è±¡ä¸­çš„èµ„æºè¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆæ‰€æœ‰å¼•ç”¨è¯¥èµ„æºçš„å¯¹è±¡å…¨éƒ¨ä¼šè¢«ä¿®æ”¹ï¼Œè¿™æ˜¾ç„¶æ˜¯é”™è¯¯çš„</li>
</ul>
<h2 id="å†™æ—¶æ‹·è´">å†™æ—¶æ‹·è´ï¼š</h2>
<p>ä½¿ç”¨å¼•ç”¨è®¡æ•°æ—¶ï¼Œå½“å‘ç”Ÿå…±äº«èµ„æºè¢«æ”¹å˜çš„æ—¶å€™ï¼Œå°†å…±äº«èµ„æºé‡æ–°å¤åˆ¶ä¸€ä»½è¿›è¡Œä¿®æ”¹ï¼Œä¸æ”¹å˜å…±äº«èµ„æºæœ¬èº«ã€‚</p>
<h2 id="æ™ºèƒ½æŒ‡é’ˆå®ç°">æ™ºèƒ½æŒ‡é’ˆå®ç°ï¼š</h2>
<p>é¦–å…ˆä¸€ä¸ªæ™ºèƒ½æŒ‡é’ˆæ˜¯ä¸€ä¸ªç±»ï¼Œé€šè¿‡æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°å®ç°èµ„æºçš„åˆ†é…ä¸å›æ”¶ï¼š</p>
<pre><code class="language-cpp">#include &lt;iostream&gt;

using namespace std;

class smart_ptr{
public:
    explicit smart_ptr(){
        _ptr = new int;
        cout&lt;&lt;&quot;alloc ptr.&quot;&lt;&lt;endl;
    }
    ~smart_ptr(){
        delete _ptr;
        cout&lt;&lt;&quot;delete ptr.&quot;&lt;&lt;endl;
    }
    int* get(){
        return _ptr;
    }
private:
    int* _ptr;
};

int main(){
    smart_ptr ptr;
    return 0;
}
</code></pre>
<p>è¿™ä¸ªç±»å¯ä»¥å®Œæˆæ™ºèƒ½æŒ‡é’ˆçš„æœ€åŸºæœ¬åŠŸèƒ½ï¼šå¯¹è¶…å‡ºä½œç”¨åŸŸçš„å¯¹è±¡è¿›è¡Œé‡Šæ”¾ï¼Œä½†å®ƒç¼ºå°‘äº†ï¼š</p>
<ul>
<li>è¿™ä¸ªç±»åªé€‚ç”¨äºint</li>
<li>è¿™ä¸ªç±»ç”¨èµ·æ¥ä¸åƒæŒ‡é’ˆ</li>
<li>æ‹·è´è¯¥ç±»å¯¹è±¡ä¼šå¼•å‘ç¨‹åºè¡Œä¸ºå¼‚å¸¸</li>
</ul>
<h3 id="æ¨¡æ¿åŒ–">æ¨¡æ¿åŒ–ï¼š</h3>
<p>è¦è®©è¿™ä¸ªç±»èƒ½å¤ŸåŒ…è£…ä»»æ„ç±»å‹çš„æŒ‡é’ˆï¼Œéœ€è¦æŠŠå®ƒå˜æˆä¸€ä¸ªç±»æ¨¡æ¿ï¼š</p>
<pre><code class="language-cpp">#include &lt;iostream&gt;

using namespace std;

class A{
public:
    void get(){
    cout&lt;&lt;&quot;the val of this class is:&quot;&lt;&lt;val&lt;&lt;endl;
}
private:
    int val = 1;
};
template &lt;typename T&gt;
class smart_ptr{
public:
    explicit smart_ptr(T* ptr = nullptr): _ptr(ptr){
        cout&lt;&lt;&quot;alloc ptr.&quot;&lt;&lt;endl;
    }
    ~smart_ptr(){
        delete _ptr;
        cout&lt;&lt;&quot;delete ptr.&quot;&lt;&lt;endl;
    }
    T* get(){
        return _ptr;
    }
private:
    T* _ptr;
};

int main(){
    smart_ptr&lt;A&gt; ptr(new A);
    ptr.get()-&gt;get();
    smart_ptr&lt;int&gt; ptr2(new int(5));
    cout&lt;&lt;&quot;the value of ptr2:&quot;&lt;&lt;*(ptr2.get())&lt;&lt;endl;
    return 0;
}
</code></pre>
<p>å¥½äº†ï¼Œé€šè¿‡å°†è¿™ä¸ªç±»æ¨¡æ¿åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ™ºèƒ½æŒ‡é’ˆç”¨äºä»»ä½•ç±»å‹ã€‚</p>
<p>è¾“å‡ºä¸ºï¼š</p>
<pre><code>alloc ptr.
the val of this class is:1
alloc ptr.
the value of ptr2:5
delete ptr.
delete ptr.
</code></pre>
<h3 id="è¿ç®—ç¬¦é‡è½½">è¿ç®—ç¬¦é‡è½½ï¼š</h3>
<p>ä¸ºäº†è®©è¿™ä¸ªç±»ç”¨èµ·æ¥æ›´åƒä¸€ä¸ªæŒ‡é’ˆï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹ä»¥ä¸‹çš„è¿ç®—ç¬¦è¿›è¡Œé‡è½½ï¼š</p>
<pre><code class="language-cpp">T&amp; operator*() const{ return *_ptr;}
T* operator-&gt;() const{ return _ptr;}
</code></pre>
<pre><code class="language-cpp">int main(){
    smart_ptr&lt;A&gt; ptr(new A);
    ptr-&gt;get();
    (*ptr).get();
    return 0;
}
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="language-cpp">alloc ptr.
the val of this class is:1
the val of this class is:1
delete ptr.
</code></pre>
<h3 id="æ‹·è´æ„é€ å’Œèµ‹å€¼">æ‹·è´æ„é€ å’Œèµ‹å€¼ï¼š</h3>
<p>æˆ‘ä»¬åº”è¯¥å¦‚ä½•å®šä¹‰æ‹·è´çš„è¡Œä¸ºï¼Œå‡è®¾æœ‰å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="language-cpp">smart_ptr&lt;A&gt; ptr1(new B); //Bæ˜¯Açš„å­ç±»
smart_ptr&lt;A&gt; ptr2{ptr1};
</code></pre>
<pre><code class="language-cpp">template &lt;typename T&gt;
class smart_ptr {
  â€¦
  smart_ptr(smart_ptr&amp; other)
  {
    ptr_ = other.release();//æ‹·è´æ„é€ å‡½æ•°è®©ä¼ å…¥çš„å¯¹è±¡å¤±å»æ‰€æœ‰æƒï¼ŒåŒæ—¶æ‹·è´å¯¹è±¡æ¥ç®¡æ‰€æœ‰æƒ
  }
  smart_ptr&amp; operator=(smart_ptr&amp; rhs)
  {
		//è¿™é‡Œé¦–å…ˆè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªä¸´æ—¶ç±»smart_ptr(rhs)ï¼ŒthisæŒ‡é’ˆå’Œrhsäº¤æ¢
		//ä¸´æ—¶å¯¹è±¡æ‹¿åˆ°thisä¹‹å‰ç»´æŠ¤çš„æŒ‡é’ˆéšç€ä¸´æ—¶å¯¹è±¡çš„ææ„å›æ”¶
    smart_ptr(rhs).swap(*this);
    return *this;
  }
  â€¦
  T* release()
  {
    T* ptr = ptr_;
    ptr_ = nullptr;
    return ptr;
  }
  void swap(smart_ptr&amp; rhs)
  {
    using std::swap;
    swap(ptr_, rhs.ptr_);
  }
  â€¦
};
</code></pre>
<h3 id="ç§»åŠ¨æŒ‡é’ˆ">ç§»åŠ¨æŒ‡é’ˆï¼š</h3>
<pre><code class="language-cpp">template &lt;typename T&gt;
class smart_ptr {
  â€¦
  smart_ptr(smart_ptr&amp;&amp; other)
  {
    ptr_ = other.release();
  }
  smart_ptr&amp; operator=(smart_ptr rhs)
  {
    smart_ptr(rhs).swap(*this);
    return *this;
  }
  â€¦
};
</code></pre>
<p>ä¿®æ”¹çš„åœ°æ–¹ï¼š</p>
<ul>
<li>æŠŠæ‹·è´æ„é€ å‡½æ•°ä¸­çš„å‚æ•°ç±»å‹  <code>smart_ptr&amp;</code> æ”¹æˆäº†  <code>smart_ptr&amp;&amp;</code>ï¼›ç°åœ¨å®ƒæˆäº†ç§»åŠ¨æ„é€ å‡½æ•°ã€‚</li>
<li>æŠŠèµ‹å€¼å‡½æ•°ä¸­çš„å‚æ•°ç±»å‹  <code>smart_ptr&amp;</code> æ”¹æˆäº† <code>smart_ptr</code>ï¼Œåœ¨æ„é€ å‚æ•°æ—¶ç›´æ¥ç”Ÿæˆæ–°çš„æ™ºèƒ½æŒ‡é’ˆï¼Œä»è€Œä¸å†éœ€è¦åœ¨å‡½æ•°ä½“ä¸­æ„é€ ä¸´æ—¶å¯¹è±¡ã€‚ç°åœ¨èµ‹å€¼å‡½æ•°çš„è¡Œä¸ºæ˜¯ç§»åŠ¨è¿˜æ˜¯æ‹·è´ï¼Œå®Œå…¨ä¾èµ–äºæ„é€ å‚æ•°æ—¶èµ°çš„æ˜¯ç§»åŠ¨æ„é€ è¿˜æ˜¯æ‹·è´æ„é€ ã€‚</li>
</ul>
<p>æ ¹æ® C++ çš„è§„åˆ™ï¼Œå¦‚æœæˆ‘æä¾›äº†ç§»åŠ¨æ„é€ å‡½æ•°è€Œæ²¡æœ‰æ‰‹åŠ¨æä¾›æ‹·è´æ„é€ å‡½æ•°ï¼Œé‚£åè€…è‡ªåŠ¨è¢«ç¦ç”¨</p>
<pre><code class="language-cpp">int main(){
    smart_ptr&lt;A&gt; ptr1{new B};
    //ptr-&gt;get();
    //(*ptr).get();
    smart_ptr&lt;A&gt; ptr2{std::move(ptr1)};
    ptr2-&gt;get();
    return 0;
}
</code></pre>
<p>è¾“å‡ºä¸ºï¼š</p>
<pre><code class="language-cpp">alloc ptr.
the val of this class is:1
delete ptr.
delete ptr.
</code></pre>
<h3 id="å­ç±»æŒ‡é’ˆå‘åŸºç±»æŒ‡é’ˆçš„è½¬æ¢">å­ç±»æŒ‡é’ˆå‘åŸºç±»æŒ‡é’ˆçš„è½¬æ¢ï¼š</h3>
<pre><code class="language-cpp">template&lt;typename U&gt;
    explicit smart_ptr(smart_ptr&lt;U&gt;&amp;&amp; other){
        _ptr = other.relese();
    }
</code></pre>
<h3 id="å¼•ç”¨è®¡æ•°-2">å¼•ç”¨è®¡æ•°ï¼š</h3>
<p>ä¸Šé¢çš„æ™ºèƒ½æŒ‡é’ˆåŸºæœ¬å®Œæˆäº†unique_ptrçš„åŠŸèƒ½ï¼Œä¸€ä¸ªå¯¹è±¡åªèƒ½è¢«å•ä¸ªunique_ptræ‹¥æœ‰ï¼Œæ˜¾ç„¶ä¸èƒ½æ»¡è¶³æ‰€æœ‰ä½¿ç”¨åœºæ™¯ï¼Œä¸€ç§å¸¸è§çš„æƒ…å†µæ˜¯ï¼šå¤šä¸ªæ™ºèƒ½æŒ‡é’ˆåŒæ—¶æ‹¥æœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œå½“ä»–ä»¬å…¨éƒ¨å¤±æ•ˆæ—¶ï¼Œè¿™ä¸ªå¯¹è±¡ä¹ŸåŒæ—¶ä¼šè¢«åˆ é™¤ï¼Œè¿™ä¹Ÿå°±æ˜¯shared_pträº†ã€‚å¤šä¸ªä¸åŒçš„shared_pträ¸ä»…å¯ä»¥å…±äº«ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶è¿˜åº”å…±äº«åŒä¸€è®¡æ•°å™¨ã€‚</p>
<p>è®¡æ•°å™¨æ¥å£ï¼š</p>
<pre><code class="language-cpp">class share_count{
public:
    share_count();
    void add_account();
    long reduce_count();
    long get_count() const;
};
</code></pre>
<p>è¿™ä¸ªshare_countç±»é™¤æ„é€ å‡½æ•°å¤–æœ‰ä¸‰ä¸ªæ–¹æ³•ï¼šå¢åŠ è®¡æ•°ï¼Œå‡å°‘è®¡æ•°ï¼Œè·å–è®¡æ•°ã€‚å¢åŠ è®¡æ•°ä¸éœ€è¦è¿”å›å€¼ï¼Œå‡å°‘è®¡æ•°éœ€è¦è¿”å›å½“å‰è®¡æ•°ä»¥åˆ¤æ–­æ˜¯ä¸æ˜¯æœ€åä¸€ä¸ªå…±äº«è®¡æ•°çš„share_ptrã€‚</p>
<pre><code class="language-cpp">class shared_count{
public:
    shared_count() : _count(1){}
    void add_account(){
        ++_count;
    }
    long reduce_count(){
        return --_count;
    }
    long get_count() const{
        return _count;
    }

private:
    long _count;
};
</code></pre>
<p>åŠ ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å°†å¼•ç”¨è®¡æ•°å™¨åŠ å…¥åˆ°æˆ‘ä»¬çš„æ™ºèƒ½æŒ‡é’ˆé‡Œäº†ï¼š</p>
<pre><code class="language-cpp">template &lt;typename T&gt;
class smart_ptr{
    explicit smart_ptr(T* ptr = nullptr): _ptr(ptr) {
     if(ptr){
         _shared_count = new shared_count();
     }   
    }
    ~smart_ptr(){
        if(_ptr &amp;&amp; !_shared_count-&gt;reduce_count()){
            delete _ptr;
            delete _shared_count;
        }
    }
private:
    smart_ptr* _ptr;
    shared_count* _shared_count;
};
</code></pre>
<p>é€»è¾‘å¾ˆæ¸…æ™°ï¼Œå½“ç„¶æˆ‘ä»¬è¿˜æœ‰æ›´å¤šç»†èŠ‚éœ€è¦å¤„ç†ï¼š</p>
<pre><code class="language-cpp">void swap(smart_ptr&amp; rhs){
        using std::swap;
        swap(_ptr, rhs._ptr);
        swap(_shared_count, rhs._shared_count);
    }
</code></pre>
<p>èµ‹å€¼å‡½æ•°å¯ä»¥ä¸å˜ï¼Œä½†æ˜¯æ‹·è´æ„é€ å‡½æ•°å’Œç§»åŠ¨æ„é€ å‡½æ•°éœ€è¦æ›´æ–°ï¼š</p>
<pre><code class="language-cpp">		//èµ‹å€¼å‡½æ•°
    smart_ptr&amp; operator=(smart_ptr rhs){
        rhs.swap(*this);
        return *this;
    }
    //æ‹·è´æ„é€ å‡½æ•°
    smart_ptr(const smart_ptr&amp; other){
        _ptr = other._ptr;
        if(_ptr){
            other._shared_count-&gt;add_account();
            _shared_count = other._shared_count;
        }
    }
    template&lt;typename U&gt;
    explicit smart_ptr(const smart_ptr&lt;U&gt;&amp; other){
        _ptr = other._ptr;
        if(_ptr){
            other._shared_count-&gt;add_account();
            _shared_count = other._shared_count;
        }
    }
    //ç§»åŠ¨æ„é€ å‡½æ•°
    template&lt;typename U&gt;
    explicit smart_ptr(smart_ptr&lt;U&gt;&amp;&amp; other){
        _ptr = other._ptr;
        if(_ptr){
            _shared_count = other._shared_count;
            other._ptr = nullptr;
        }
    }
</code></pre>
<p>å› ä¸ºæ¨¡æ¿çš„å®ä¾‹ä¹‹é—´å¹¶ä¸å¤©ç„¶å°±æœ‰friendå…³ç³»ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä»£ç ä¼šæŠ¥é”™ï¼Œæˆ‘ä»¬éœ€è¦åœ¨smart_ptrçš„å®šä¹‰ä¸­æ˜¾å¼çš„å£°æ˜ï¼š</p>
<pre><code class="language-cpp">template&lt;typename U&gt;
friend class smart_ptr;
</code></pre>
<p>æ·»åŠ ä¸€ä¸ªè·å–å½“å‰å¼•ç”¨è®¡æ•°çš„å‡½æ•°ï¼š</p>
<pre><code class="language-cpp">long use_count() const{
        if(_ptr){
            return _shared_count-&gt;get_count();
        }else{
            return 0;
        }
    }
</code></pre>
<p>æµ‹è¯•ä¸€ä¸‹ï¼š</p>
<pre><code class="language-cpp">class A{
public:
    void get(){
    cout&lt;&lt;&quot;the val of this class is:&quot;&lt;&lt;val&lt;&lt;endl;
		}
		virtual ~A()=default;
private:
    int val = 1;
};

class B:public A{
public:
    void getb() {
        cout &lt;&lt; &quot;the val of this class is:&quot; &lt;&lt; bval &lt;&lt; endl;
    }
private:
    int bval = 2;
};
int main(){
    smart_ptr&lt;B&gt; ptr1{new B};
    cout&lt;&lt;&quot;use count of ptr1 is:&quot;&lt;&lt;ptr1.use_count()&lt;&lt;endl;
    smart_ptr&lt;A&gt; ptr2;
    cout&lt;&lt;&quot;use count of ptr2 is:&quot;&lt;&lt;ptr2.use_count()&lt;&lt;endl;
    ptr2 = ptr1;
    cout&lt;&lt;&quot;use count of ptr2 is:&quot;&lt;&lt;ptr2.use_count()&lt;&lt;endl;
    cout&lt;&lt;&quot;use count of ptr1 is:&quot;&lt;&lt;ptr1.use_count()&lt;&lt;endl;
    return 0;
}
</code></pre>
<p>è¾“å‡ºä¸ºï¼š</p>
<pre><code class="language-cpp">use count of ptr1 is:1
use count of ptr2 is:0
use count of ptr2 is:2
use count of ptr1 is:2
</code></pre>
<h3 id="æŒ‡é’ˆç±»å‹è½¬æ¢">æŒ‡é’ˆç±»å‹è½¬æ¢ï¼š</h3>
<p>é¦–å…ˆéœ€è¦æ·»åŠ æ„é€ å‡½æ•°ï¼Œå…è®¸åœ¨å¯¹æ™ºèƒ½æŒ‡é’ˆå†…éƒ¨çš„æŒ‡é’ˆå¯¹è±¡èµ‹å€¼æ—¶ï¼Œä½¿ç”¨ä¸€ä¸ªç°æœ‰çš„æ™ºèƒ½æŒ‡é’ˆçš„å…±äº«è®¡æ•°ï¼š</p>
<pre><code class="language-cpp">template&lt;typename U&gt;
    smart_ptr(const smart_ptr&lt;U&gt;&amp; other, T* ptr){
        _ptr = ptr;
        if(_ptr){
            other._shared_count-&gt;add_account();
            _shared_count = other._shared_count;
        }
    }
</code></pre>
<pre><code class="language-cpp">template&lt;typename T, typename U&gt;
smart_ptr&lt;T&gt; dynamic_pointer_cast(const smart_ptr&lt;U&gt;&amp; other){
    T* ptr = dynamic_cast&lt;T*&gt;(other.get());
    return smart_ptr&lt;T&gt;(other, ptr);
}
</code></pre>
<p>æµ‹è¯•ï¼š</p>
<pre><code class="language-cpp">int main(){
    smart_ptr&lt;B&gt; ptr1{new B};
    cout&lt;&lt;&quot;use count of ptr1 is:&quot;&lt;&lt;ptr1.use_count()&lt;&lt;endl;
    smart_ptr&lt;A&gt; ptr2;
    cout&lt;&lt;&quot;use count of ptr2 is:&quot;&lt;&lt;ptr2.use_count()&lt;&lt;endl;
    ptr2 = ptr1;
    cout&lt;&lt;&quot;use count of ptr2 is:&quot;&lt;&lt;ptr2.use_count()&lt;&lt;endl;
    cout&lt;&lt;&quot;use count of ptr1 is:&quot;&lt;&lt;ptr1.use_count()&lt;&lt;endl;
    smart_ptr&lt;B&gt; ptr3 = dynamic_pointer_cast&lt;B&gt;(ptr2);
    cout&lt;&lt;&quot;use count of ptr3 is:&quot;&lt;&lt;ptr3.use_count()&lt;&lt;endl;
    return 0;
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="language-cpp">use count of ptr1 is:1
use count of ptr2 is:0
use count of ptr2 is:2
use count of ptr1 is:2
use count of ptr3 is:3
</code></pre>
<p>å®Œæ•´ä»£ç (å¾…å®Œå–„)ï¼š</p>
<pre><code class="language-cpp">class shared_count{
public:
    shared_count() : _count(1){}
    void add_account(){
        ++_count;
    }
    long reduce_count(){
        return --_count;
    }
    long get_count() const{
        return _count;
    }

private:
    long _count;
};

template &lt;typename T&gt;
class smart_ptr{
public:
    template&lt;typename U&gt;
    friend class smart_ptr;
    //æ„é€ å‡½æ•°
    explicit smart_ptr(T* ptr = nullptr): _ptr(ptr) {
     if(ptr){
         _shared_count = new shared_count();
     }
    }
    //æ™ºèƒ½æŒ‡é’ˆç±»å‹è½¬æ¢
    template&lt;typename U&gt;
    smart_ptr(const smart_ptr&lt;U&gt;&amp; other, T* ptr){
        _ptr = ptr;
        if(_ptr){
            other._shared_count-&gt;add_account();
            _shared_count = other._shared_count;
        }
    }
    //èµ‹å€¼å‡½æ•°
    smart_ptr&amp; operator=(smart_ptr rhs){
        rhs.swap(*this);
        return *this;
    }
    //æ‹·è´æ„é€ å‡½æ•°
    smart_ptr(const smart_ptr&amp; other){
        _ptr = other._ptr;
        if(_ptr){
            other._shared_count-&gt;add_account();
            _shared_count = other._shared_count;
        }
    }
    template&lt;typename U&gt;
    smart_ptr(const smart_ptr&lt;U&gt;&amp; other){
        _ptr = other._ptr;
        if(_ptr){
            other._shared_count-&gt;add_account();
            _shared_count = other._shared_count;
        }
    }
    //ç§»åŠ¨æ„é€ å‡½æ•°
    template&lt;typename U&gt;
    smart_ptr(smart_ptr&lt;U&gt;&amp;&amp; other){
        _ptr = other._ptr;
        if(_ptr){
            _shared_count = other._shared_count;
            other._ptr = nullptr;
        }
    }
    ~smart_ptr(){
        if(_ptr &amp;&amp; !_shared_count-&gt;reduce_count()){
            delete _ptr;
            delete _shared_count;
        }
    }
    void swap(smart_ptr&amp; rhs){
        using std::swap;
        swap(_ptr, rhs._ptr);
        swap(_shared_count, rhs._shared_count);
    }
    long use_count() const{
        if(_ptr){
            return _shared_count-&gt;get_count();
        }else{
            return 0;
        }
    }
    /*
     * é‡è½½è¿ç®—ç¬¦
     */
    T&amp; operator*() const{ return *_ptr;}
    T* operator-&gt;() const{ return _ptr;}

    T* get() const {
        return _ptr;
    }
private:
    T* _ptr;
    shared_count* _shared_count;
};

template&lt;typename T, typename U&gt;
smart_ptr&lt;T&gt; dynamic_pointer_cast(const smart_ptr&lt;U&gt;&amp; other){
    T* ptr = dynamic_cast&lt;T*&gt;(other.get());
    return smart_ptr&lt;T&gt;(other, ptr);
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[LeetCode å­˜åœ¨é‡å¤å…ƒç´ ]]></title>
        <id>https://theNefelibata.github.io/post/leetcode-cun-zai-chong-fu-yuan-su/</id>
        <link href="https://theNefelibata.github.io/post/leetcode-cun-zai-chong-fu-yuan-su/">
        </link>
        <updated>2021-04-19T15:31:23.000Z</updated>
        <content type="html"><![CDATA[<h2 id="iié¢˜ç›®">IIé¢˜ç›®ï¼š</h2>
<p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„å’Œä¸€ä¸ªæ•´æ•° kï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨ä¸¤ä¸ªä¸åŒçš„ç´¢å¼• i å’Œ jï¼Œä½¿å¾— nums [i] = nums [j]ï¼Œå¹¶ä¸” i å’Œ j çš„å·®çš„ ç»å¯¹å€¼ è‡³å¤šä¸º kã€‚</p>
<pre><code class="language-other">ç¤ºä¾‹ 1:

è¾“å…¥: nums = [1,2,3,1], k = 3
è¾“å‡º: true
ç¤ºä¾‹ 2:

è¾“å…¥: nums = [1,0,1,1], k = 1
è¾“å‡º: true
ç¤ºä¾‹ 3:

è¾“å…¥: nums = [1,2,3,1,2,3], k = 2
è¾“å‡º: false
</code></pre>
<h2 id="iiié¢˜è§£">IIIé¢˜è§£ï¼š</h2>
<p>ç»´æŠ¤ä¸€ä¸ªå¤§å°ä¸ºKçš„é˜Ÿåˆ—Qï¼Œéå†numsï¼Œå¦‚æœnums[i]åœ¨é˜Ÿåˆ—Qä¸­ï¼Œåˆ™è¿”å›Trueï¼Œå¦åˆ™ï¼Œå°†nums[i]åŠ å…¥é˜Ÿåˆ—Qï¼Œå°†Qå¤šä½™å…ƒç´ å‡ºé˜Ÿã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://res.craft.do/user/preview/3d558d30-7d8a-2616-b1b6-30cf7984eb4b/doc/7237F646-A02F-4975-84A8-2AD1B64CA456/633B44AA-7AA4-4834-850E-92153760C8F0_1" alt="Drawing" loading="lazy"></figure>
<pre><code class="language-python">class Solution:
	def containsNearbyDuplicate(self, nums: List[int], k: int) -&gt; bool:
		queue = []
		if k == 0:
			return False
		for i in nums:
			if i not in queue:
				if len(queue) &lt; k:
					queue.append(i)
				else:
					queue.pop(0)
					queue.append(i)
			else:
				return True
		return False
</code></pre>
<h2 id="iiié¢˜ç›®">IIIé¢˜ç›®ï¼š</h2>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸¤ä¸ªæ•´æ•° k å’Œ t ã€‚è¯·ä½ åˆ¤æ–­æ˜¯å¦å­˜åœ¨ ä¸¤ä¸ªä¸åŒä¸‹æ ‡ i å’Œ jï¼Œä½¿å¾— <code>abs(nums[i] - nums[j]) &lt;= t</code>  ï¼ŒåŒæ—¶åˆæ»¡è¶³ <code>abs(i - j) &lt;= k</code> ã€‚</p>
<p>å¦‚æœå­˜åœ¨åˆ™è¿”å› trueï¼Œä¸å­˜åœ¨è¿”å› falseã€‚</p>
<pre><code class="language-python">ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼šnums = [1,2,3,1], k = 3, t = 0
è¾“å‡ºï¼štrue
ç¤ºä¾‹ 2ï¼š

è¾“å…¥ï¼šnums = [1,0,1,1], k = 1, t = 2
è¾“å‡ºï¼štrue
ç¤ºä¾‹ 3ï¼š

è¾“å…¥ï¼šnums = [1,5,9,1,5,9], k = 2, t = 3
è¾“å‡ºï¼šfalse
</code></pre>
<h2 id="iiié¢˜è§£-2">IIIé¢˜è§£</h2>
<p>ä»å¤´å¼€å§‹éå†æ•°ç»„ï¼Œå¯¹äºå½“å‰ä¸‹æ ‡iï¼Œä¸ºä¸‹æ ‡ä¸º[i-k,i+k]çš„å…ƒç´ æ„é€ æ¡¶ğŸª£ï¼Œå¯¹äºæ¯ä¸ªiæˆ‘ä»¬åªéœ€çœ‹å‰é¢æ˜¯å¦æœ‰æ— æ•ˆæ¡¶ï¼Œå°†nums[i-(k+1)]çš„æ¡¶åˆ é™¤ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https://res.craft.do/user/preview/3d558d30-7d8a-2616-b1b6-30cf7984eb4b/doc/7237F646-A02F-4975-84A8-2AD1B64CA456/C260CF26-75CD-4983-8BF1-2EF05A4F5405_1" alt="Drawing" loading="lazy"></figure>
<p>å¯¹äºå…ƒç´ nums[i]ï¼Œè·å–å½“å‰æ¡¶idï¼Œå¦‚æœå­˜åœ¨çš„è¯è¯´æ˜æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œå¦‚æœå½“å‰æ¡¶æ²¡æœ‰å…ƒç´ ï¼Œåˆ™æ¯”è¾ƒç›¸é‚»æ¡¶ï¼Œæœ‰å…ƒç´ çš„è¯åšå·®æ¯”è¾ƒï¼Œå¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°†å½“å‰å…ƒç´ è£…å…¥æ¡¶ä¸­ã€‚</p>
<ul>
<li>åˆ†æ¡¶æ—¶ï¼Œå¦‚æœt=0, åˆ™<code>nums[i]//t</code> ä¸å¯è¡Œï¼Œè€ƒè™‘<code>nums[i]//t+1</code> ;</li>
<li>è‹¥<code>nums[i]&lt;0</code>ï¼Œè¿›è¡Œ<code>(x+1)//(t+1)-1</code></li>
</ul>
<figure data-type="image" tabindex="3"><img src="https://res.craft.do/user/preview/3d558d30-7d8a-2616-b1b6-30cf7984eb4b/doc/7237F646-A02F-4975-84A8-2AD1B64CA456/E01AEB84-A925-42A0-8406-34CE0294762D_1" alt="Drawing" loading="lazy"></figure>
<h2 id="iiiä»£ç ">IIIä»£ç </h2>
<pre><code class="language-python">class Solution:
	def containsNearbyAlmostDuplicate(self, nums: List[int], k: int, t: int) -&gt; bool:
		def getID(x, t):
			return (x+1)//(t+1)-1 if x&lt;0 else x//(t+1)
		
		n = len(nums)
		m = {}
		for i in range(n):
			x = nums[i]
			idx = getID(x, t)
			if idx in m:
				return True
			l , r = idx-1, idx+1
			if l in m and abs(x - m[l]) &lt;= t:
				return True
			if r in m and abs(x - m[r]) &lt;= t:
				return True
			m[idx] = x
			if i &gt;= k:
				m.pop(getID(nums[i-k],t))
		return False
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[GitåŸºç¡€]]></title>
        <id>https://theNefelibata.github.io/post/git-ji-chu/</id>
        <link href="https://theNefelibata.github.io/post/git-ji-chu/">
        </link>
        <updated>2021-04-04T09:45:32.000Z</updated>
        <content type="html"><![CDATA[<h2 id="ç‰ˆæœ¬ç®¡ç†å’Œgitçš„è®¾è®¡">ç‰ˆæœ¬ç®¡ç†å’ŒGitçš„è®¾è®¡</h2>
<h3 id="ç‰ˆæœ¬ç®¡ç†çš„éœ€æ±‚">ç‰ˆæœ¬ç®¡ç†çš„éœ€æ±‚</h3>
<figure data-type="image" tabindex="1"><img src="https://theNefelibata.github.io//post-images/1617529645552.jpg" alt="" loading="lazy"></figure>
<ul>
<li><em><strong>æ—¶é—´æœºå™¨</strong></em>ï¼š
<ul>
<li>å…¨é‡æ–¹æ¡ˆï¼šä¿å­˜é¡¹ç›®çš„æ¯ä¸€ä¸ªç‰ˆæœ¬çš„å®Œæ•´ä¿¡æ¯</li>
<li>å¢é‡æ–¹æ¡ˆï¼šä¿å­˜æ¯ä¸€ç‰ˆçš„ä¿®æ”¹ï¼Œç‰ˆæœ¬ä¸€+è¡¥ä¸=ç‰ˆæœ¬äºŒ</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">ä¼˜ç‚¹</th>
<th style="text-align:center">ç¼ºç‚¹</th>
<th style="text-align:center">ä½¿ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">å…¨é‡æ–¹æ¡ˆ</td>
<td style="text-align:center">ç®€å•ã€å¿«é€Ÿ</td>
<td style="text-align:center">é‡å¤å­˜å‚¨ï¼Œæµªè´¹ç©ºé—´</td>
<td style="text-align:center">ä»£ç ï¼Œæ–‡æœ¬</td>
</tr>
<tr>
<td style="text-align:center">å¢é‡æ–¹æ¡ˆ</td>
<td style="text-align:center">å­˜å‚¨ç©ºé—´å°</td>
<td style="text-align:center">éœ€è¦è¿ç®—ï¼Œé™ä½äº†æ€§èƒ½ï¼Œå¢åŠ äº†è¿ç®—æ—¶é—´</td>
<td style="text-align:center">è§†é¢‘ï¼Œå¤§å‹äºŒè¿›åˆ¶æ–‡ä»¶</td>
</tr>
</tbody>
</table>
<p><img src="https://theNefelibata.github.io//post-images/1617529669702.jpg" alt="" loading="lazy"><br>
ç³»ç»Ÿè®°å½•äº†æ¯ä¸€ä¸ªä¿®æ”¹ç‰ˆæœ¬çš„å®Œæ•´ä¿¡æ¯ï¼Œå­˜å‚¨åœ¨.gitä¸­</p>
<p><em><strong>æ–‡ä»¶å‘½å</strong></em><br>
ä½¿ç”¨æ–‡ä»¶çš„SHA-1å€¼æ¥å‘½åæ–‡ä»¶ã€‚<br>
<img src="https://theNefelibata.github.io//post-images/1617529678048.jpg" alt="" loading="lazy"></p>
<h3 id="treeç»“æ„å’Œæš‚å­˜åŒº">Treeç»“æ„å’Œæš‚å­˜åŒº</h3>
<p><img src="https://theNefelibata.github.io//post-images/1617529699670.jpg" alt="" loading="lazy"><br>
<em><strong>ç›®å½•ç»“æ„å’Œå¯¹åº”å…³ç³»</strong></em><br>
<img src="https://theNefelibata.github.io//post-images/1617529689632.jpg" alt="" loading="lazy"><br>
Treeæ˜¯æ–‡ä»¶å¤¹ï¼Œblobæ˜¯äºŒè¿›åˆ¶æ–‡ä»¶<br>
<img src="https://theNefelibata.github.io//post-images/1617529709801.jpg" alt="" loading="lazy"><br>
<em><strong>æš‚å­˜åŒº</strong></em><br>
æ–‡ä»¶çŠ¶æ€<br>
<img src="https://theNefelibata.github.io//post-images/1617529730491.jpg" alt="" loading="lazy"></p>
<table>
<thead>
<tr>
<th style="text-align:center">code</th>
<th style="text-align:center">index</th>
<th style="text-align:center">SHA-1</th>
<th style="text-align:center">Status</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">åœ¨</td>
<td style="text-align:center">åœ¨</td>
<td style="text-align:center">ä¸åŒ¹é…</td>
<td style="text-align:center">modified</td>
</tr>
<tr>
<td style="text-align:center">ä¸å­˜åœ¨</td>
<td style="text-align:center">åœ¨</td>
<td style="text-align:center"></td>
<td style="text-align:center">removed</td>
</tr>
<tr>
<td style="text-align:center">åœ¨</td>
<td style="text-align:center">ä¸å­˜åœ¨</td>
<td style="text-align:center"></td>
<td style="text-align:center">added</td>
</tr>
</tbody>
</table>
<h3 id="ååŒå’Œåˆ†æ”¯">ååŒå’Œåˆ†æ”¯</h3>
<p><em><strong>åˆ†å¸ƒå¼çš„ç‰ˆæœ¬æ§åˆ¶</strong></em><br>
æ¯ä¸ªäººçš„ç”µè„‘ä¸Šéƒ½å­˜æ”¾ä¸€ä¸ªå®Œæ•´çš„ç‰ˆæœ¬ä»“åº“<br>
<em><strong>å†²çªå’Œåˆå¹¶</strong></em><br>
å¦‚æœä¸¤ä¸ªäººä¿®æ”¹äº†åŒä¸€ä¸ªæ–‡ä»¶File1ï¼Œç¬¬ä¸€ä¸ªäººpushï¼Œæ²¡æœ‰é—®é¢˜ï¼Œç¬¬äºŒä¸ªå¤–äººpushï¼Œä¼šæç¤ºFile1å†²çªï¼Œéœ€è¦è§£å†³å†²çªå†æäº¤</p>
<p><img src="https://theNefelibata.github.io//post-images/1617529758128.jpg" alt="" loading="lazy"><br>
<em><strong>åˆ†æ”¯</strong></em><br>
<img src="https://theNefelibata.github.io//post-images/1617529812308.jpg" alt="" loading="lazy"><br>
<em><strong>åˆå¹¶</strong></em><br>
mergeã€rebaseã€cherry-pick</p>
<h2 id="å¸¸ç”¨gitå‘½ä»¤">å¸¸ç”¨Gitå‘½ä»¤</h2>
<ul>
<li><code>git init</code>
<ul>
<li>gitåˆå§‹åŒ–å‘½ä»¤</li>
<li>å°†ä¸€ä¸ªæ–‡ä»¶å¤¹åˆå§‹åŒ–ä¸ºgitä»“åº“</li>
</ul>
</li>
<li><code>git add filename</code>
<ul>
<li><code>git add ./*</code> å°†æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº</li>
<li>å°†filenameæ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº</li>
</ul>
</li>
<li><code>git status</code>
<ul>
<li>æŸ¥çœ‹æš‚å­˜åŒºçŠ¶æ€</li>
</ul>
</li>
<li><code>git reset HEAD--a.txt</code>
<ul>
<li>å°†æ–‡ä»¶ç§»å‡ºæš‚å­˜åŒº</li>
</ul>
</li>
<li><code>git cat-file -p SHA-1</code>
<ul>
<li>æŸ¥çœ‹SHA-1æ–‡ä»¶å†…å®¹</li>
</ul>
</li>
<li><code>git ls-files --stage</code>
<ul>
<li>æŸ¥çœ‹æš‚å­˜åŒºå†…å®¹</li>
</ul>
</li>
<li><code>git commit -m â€˜ â€˜</code>
<ul>
<li>å°†æš‚å­˜åŒºæ–‡ä»¶æäº¤åˆ°gitä»“åº“</li>
</ul>
</li>
<li><code>git branch name</code>
<ul>
<li>åˆ›å»ºä¸€ä¸ªåä¸ºnameçš„åˆ†æ”¯</li>
</ul>
</li>
<li><code>git checkout name</code>
<ul>
<li>åˆ‡æ¢åˆ°æŸä¸ªåˆ†æ”¯</li>
<li>å›åˆ°æŸä¸ªå†å²åˆ†æ”¯<code>git checkout SHA-1</code></li>
<li><code>git checkout -b name</code> åˆ›å»ºä¸€ä¸ªåˆ†æ”¯å¹¶åˆ‡æ¢åˆ°åˆ†æ”¯</li>
</ul>
</li>
<li><code>git merge branch-name</code>
<ul>
<li>å°†åˆ†æ”¯branch-nameåˆå¹¶åˆ°å½“å‰åˆ†æ”¯</li>
</ul>
</li>
<li>åˆå¹¶å¤±è´¥ï¼š
<ul>
<li><code>git merge --abort</code>æ”¾å¼ƒåˆå¹¶</li>
<li>æ‰‹åŠ¨è§£å†³å†²çªåå†æäº¤ï¼Œç„¶ååˆå¹¶</li>
</ul>
</li>
<li><code>git log</code>
<ul>
<li>æŸ¥çœ‹gitæ—¥å¿—</li>
</ul>
</li>
<li><code>git pull (origin main)</code>
<ul>
<li>å°†è¿œç¨‹ä»“åº“çš„å†…å®¹åˆå¹¶åˆ°æœ¬åœ°ä»“åº“</li>
</ul>
</li>
<li><code>git push</code>
<ul>
<li>å°†æœ¬åœ°ä»“åº“çš„å†…å®¹pushåˆ°è¿œç¨‹ä»“åº“</li>
</ul>
</li>
<li><code>git stash</code>
<ul>
<li>å°†å½“å‰ä¿®æ”¹æ”¾å…¥ä¸€ä¸ªåˆ—è¡¨
<ul>
<li><code>git stash list</code></li>
<li><code>git stash apply</code></li>
</ul>
</li>
<li><code>git stash show/drop/clear</code></li>
</ul>
</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[LeetCode æ£®æ—ä¸­çš„å…”å­]]></title>
        <id>https://theNefelibata.github.io/post/leetcode-sen-lin-zhong-de-tu-zi/</id>
        <link href="https://theNefelibata.github.io/post/leetcode-sen-lin-zhong-de-tu-zi/">
        </link>
        <updated>2021-04-03T17:55:34.000Z</updated>
        <content type="html"><![CDATA[<h2 id="é¢˜ç›®æè¿°">é¢˜ç›®æè¿°</h2>
<p>æ£®æ—ä¸­ï¼Œæ¯ä¸ªå…”å­éƒ½æœ‰é¢œè‰²ã€‚å…¶ä¸­ä¸€äº›å…”å­ï¼ˆå¯èƒ½æ˜¯å…¨éƒ¨ï¼‰å‘Šè¯‰ä½ è¿˜æœ‰å¤šå°‘å…¶ä»–çš„å…”å­å’Œè‡ªå·±æœ‰ç›¸åŒçš„é¢œè‰²ã€‚æˆ‘ä»¬å°†è¿™äº›å›ç­”æ”¾åœ¨ answers æ•°ç»„é‡Œã€‚</p>
<p>è¿”å›æ£®æ—ä¸­å…”å­çš„æœ€å°‘æ•°é‡ã€‚</p>
<pre><code>ç¤ºä¾‹:
è¾“å…¥: answers = [1, 1, 2]
è¾“å‡º: 5
è§£é‡Š:
ä¸¤åªå›ç­”äº† &quot;1&quot; çš„å…”å­å¯èƒ½æœ‰ç›¸åŒçš„é¢œè‰²ï¼Œè®¾ä¸ºçº¢è‰²ã€‚
ä¹‹åå›ç­”äº† &quot;2&quot; çš„å…”å­ä¸ä¼šæ˜¯çº¢è‰²ï¼Œå¦åˆ™ä»–ä»¬çš„å›ç­”ä¼šç›¸äº’çŸ›ç›¾ã€‚
è®¾å›ç­”äº† &quot;2&quot; çš„å…”å­ä¸ºè“è‰²ã€‚
æ­¤å¤–ï¼Œæ£®æ—ä¸­è¿˜åº”æœ‰å¦å¤– 2 åªè“è‰²å…”å­çš„å›ç­”æ²¡æœ‰åŒ…å«åœ¨æ•°ç»„ä¸­ã€‚
å› æ­¤æ£®æ—ä¸­å…”å­çš„æœ€å°‘æ•°é‡æ˜¯ 5: 3 åªå›ç­”çš„å’Œ 2 åªæ²¡æœ‰å›ç­”çš„ã€‚

è¾“å…¥: answers = [10, 10, 10]
è¾“å‡º: 11

è¾“å…¥: answers = []
è¾“å‡º: 0
</code></pre>
<h2 id="é¢˜è§£">é¢˜è§£</h2>
<p>æŸç§é¢œè‰²çš„å…”å­æ•°ç­‰äºé‚£ç§é¢œè‰²å…”å­çš„å›ç­”æ•°+1ï¼Œé¢œè‰²ç›¸åŒçš„å…”å­çš„å›ç­”ä¸€å®šç›¸åŒï¼ŒåŸºäºè¿™ä¸¤ä¸ªç‰¹å¾ï¼Œæˆ‘ä»¬è¦æ±‚æœ€å°‘çš„å…”å­æ•°é‡ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå›ç­”ç›¸åŒçš„å…”å­å±äºä¸€ç§é¢œè‰²ï¼Œæ­¤æ—¶æˆ‘ä»¬åªéœ€ç»Ÿè®¡å‡ºå›ç­”ç›¸åŒçš„å…”å­çš„æ•°é‡ï¼Œåˆ†é…é¢œè‰²å³å¯ï¼Œç¤ºæ„å›¾å¦‚ä¸‹ï¼š<br>
<img src="https://theNefelibata.github.io//post-images/1617472566346.jpg" alt="" loading="lazy"></p>
<h2 id="ä»£ç ">ä»£ç </h2>
<pre><code class="language-python">class Solution:
	def numRabbits(self, answers: List[int]) -&gt; int:
	cnt = {}
	ans = 0
	for i in answers:
		if i not in cnt.keys():
			cnt[i] = 1
		else:
			cnt[i] += 1
	for k, v in cnt.items():
		ans += (v // (k+1)) * (k + 1)
		if (v % (k+1)) != 0 :
			ans += k + 1

	return ans
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[LeetCode æœ€é•¿å…¬å…±å­åºåˆ—]]></title>
        <id>https://theNefelibata.github.io/post/leetcode-zui-chang-gong-gong-zi-xu-lie/</id>
        <link href="https://theNefelibata.github.io/post/leetcode-zui-chang-gong-gong-zi-xu-lie/">
        </link>
        <updated>2021-04-03T14:29:33.000Z</updated>
        <content type="html"><![CDATA[<!-- more -->
<h2 id="é¢˜ç›®æè¿°">é¢˜ç›®æè¿°</h2>
<p>ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² text1   å’Œ text2ï¼Œè¿”å›è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿ å…¬å…±å­åºåˆ— çš„é•¿åº¦ã€‚å¦‚æœä¸å­˜åœ¨ å…¬å…±å­åºåˆ— ï¼Œè¿”å› 0 ã€‚<br>
ä¸€ä¸ªå­—ç¬¦ä¸²çš„ å­åºåˆ— æ˜¯æŒ‡è¿™æ ·ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼šå®ƒæ˜¯ç”±åŸå­—ç¬¦ä¸²åœ¨ä¸æ”¹å˜å­—ç¬¦çš„ç›¸å¯¹é¡ºåºçš„æƒ…å†µä¸‹åˆ é™¤æŸäº›å­—ç¬¦ï¼ˆä¹Ÿå¯ä»¥ä¸åˆ é™¤ä»»ä½•å­—ç¬¦ï¼‰åç»„æˆçš„æ–°å­—ç¬¦ä¸²ã€‚<br>
ä¾‹å¦‚ï¼Œ&quot;ace&quot; æ˜¯ &quot;abcde&quot; çš„å­åºåˆ—ï¼Œä½† &quot;aec&quot; ä¸æ˜¯ &quot;abcde&quot; çš„å­åºåˆ—ã€‚<br>
ä¸¤ä¸ªå­—ç¬¦ä¸²çš„ å…¬å…±å­åºåˆ— æ˜¯è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²æ‰€å…±åŒæ‹¥æœ‰çš„å­åºåˆ—ã€‚</p>
<h2 id="é¢˜è§£">é¢˜è§£</h2>
<p>è¿™æ˜¯ä¸€é“å…¸å‹çš„çº¿æ€§è§„åˆ’ï¼Œå®šä¹‰æ•°ç»„dp[i][j] ä¸ºtext1[0:i]å’Œtext2[0:j]æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦ã€‚</p>
<ul>
<li>å¦‚æœtext1[i] == text2[j]ï¼Œé‚£ä¹ˆdp[i][j]å°±æ˜¯dp[i-1][j-1]+1</li>
<li>å¦‚æœtext1[i] != text2[j]ï¼Œé‚£ä¹ˆdp[i][j]å°±æ˜¯text1[0:i]å’Œtext2[0:j-1]çš„æœ€é•¿å…¬å…±å­åºåˆ— å’Œ text1[0:i-1]å’Œtext2[0:j]çš„æœ€é•¿å…¬å…±å­åºåˆ— ä¸­æœ€å¤§çš„é‚£ä¸ªã€‚</li>
</ul>
<figure data-type="image" tabindex="1"><img src="https://theNefelibata.github.io//post-images/1617460209274.jpg" alt="" loading="lazy"></figure>
<h2 id="ä»£ç ">ä»£ç </h2>
<pre><code class="language-python">class Solution:
    def longestCommonSubsequence(self, text1: str, text2: str) -&gt; int:
        m = len(text1)
        n = len(text2)
        dp = [[0]*(n + 1) for _ in range(m + 1)]

        for i in range(1, m + 1):
            for j in range(1, n + 1):
                if text1[i-1] == text2[j-1]:
                    dp[i][j] = dp[i-1][j-1] + 1
                else:
                    dp[i][j] = max(dp[i][j-1], dp[i-1][j])
            
        return dp[m][n]
</code></pre>
]]></content>
    </entry>
</feed>